(in-package #:cvm.compile-file)

;;; WRITE-BYTECODE will, given a list of instructions and a stream, write out
;;; the entire FASL.

;;; Write out a FASL instruction to a ub8 stream.
(defgeneric encode (instruction stream))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;
;;; Bytecode
;;;
;;; "bytecode" is actually a little strong. This "bytecode" consists of a
;;; sequence of "instructions" that must be executed sequentially.
;;; There's no other control flow. There is no data structure involved other
;;; than the array of constants being produced (so e.g. no operand stack).
;;; All multibyte values are big-endian. All indices are one byte, or two
;;; bytes, or etc. powers of two based on how many constants there are. E.g. if
;;; there are 200 constants indices will be one byte, but if there are 300
;;; indices will be two bytes.
;;; Instruction set is copied from Clasp for now. "sind" in the below means an
;;; index that the allocated object will be stored into. This may need some
;;; review later.
;;; Operations are as follows:

(defparameter +ops+
  '((nil 65 sind)
    (t 66 sind)
    (ratio 67)
    (complex 68)
    (cons 69 sind)
    (rplaca 70 ind1 ind2) ; (setf (car [ind1]) [ind2])
    (rplacd 71 ind1 ind2)
    (make-array 74 sind rank . dims)
    (setf-row-major-aref 75 arrayind rmindex valueind)
    (make-hash-table 76 sind test count)
    ((setf gethash) 77 htind keyind valueind)
    (make-sb64 78 sind sb64)
    (find-package 79 sind nameind)
    (make-bignum 80 sind size . words)
    (make-symbol 81)
    (intern 82 sind packageind nameind)
    (make-character 83 sind ub32)
    (make-pathname 85)
    (make-bytecode-function 87)
    (make-bytecode-module 88)
    (setf-literals 89)
    (make-single-float 90 sind ub32)
    (make-double-float 91 sind ub64)
    (funcall-create 93 sind find nargs . args)
    (funcall-initialize 94 find nargs . args)
    (fdefinition 95 find nameind)
    (fcell 96 find nameind)
    (vcell 97 vind nameind)
    (find-class 98 sind cnind)
    (init-object-array 99 ub64)
    (environment 100)
    (attribute 255 name nbytes . data)))

;; how many bytes are needed to represent an index?
(defvar *index-bytes*)

;;; Write an n-byte integer to a ub8 stream, big-endian.
(defun write-b (int n stream)
  ;; write-sequence is better for this, but I don't think we can really
  ;; use it without consing or touching memory generally.
  (loop for i from (* (1- n) 8) downto 0 by 8
        for byte = (ldb (byte 8 i) int)
        do (write-byte byte stream)))

(defun write-b64 (word stream) (write-b word 8 stream))
(defun write-b32 (word stream) (write-b word 4 stream))
(defun write-b16 (word stream) (write-b word 2 stream))

(defun write-magic (stream) (write-b32 +magic+ stream))

(defun write-version (stream)
  (write-b16 *major-version* stream)
  (write-b16 *minor-version* stream))

;; Used in disltv as well.
(defun write-bytecode (instructions stream)
  (let* ((nobjs (count-if (lambda (i) (typep i 'creator)) instructions))
         ;; Next highest power of two bytes, roughly
         (*index-bytes* (ash 1 (1- (ceiling (integer-length nobjs) 8))))
         ;; 1+ for the init-object-array.
         (ninsts (1+ (length instructions))))
    (assign-indices instructions)
    (dbgprint "Instructions:狺轭篝蝓泗轱铙黩轸瀛磲玳篝蝈犴黩轸瀛鲥蝮轱篝蝈犴黩轸瀛舛铋铙趔篝蝈犴ㄥ钽镤磲脲轭篝犷沐ч铋舡镡赍泗狎蜥恒秕铘铒怅螬篝蝈犴磲铋灬礅溽ㄩ铙舂ㄥ钽镤轭篝篝蝈犴┅轭篝蝓泗轱铙┅ㄤ彐躅镳泔溴眍屙镱殂戾è轭篝ㄡ篌镢眍屙镱殂镳螳呼弩＇羼踽飑┅ㄩ轭篝箦泔钿轭篝ㄥ蝌矧Ⅴ铍铒黝眍屙镱殂幄眍屙镱殂┅┅ㄤ彐躅黩轸瀛眍屙镱殂眍屙镱殂篝蝈犴黩轸瀛怡翦镳泔溴眍屙镱殂篝蝈犴┅ㄤ彐躅黩轸瀛轭溴ㄣ蝈狒矧篝蝈犴戾è痫箝糸镱ㄩ钿屮泸遽麸颟┅ㄥ汜箦轭溴怡翦螵è暴黩轸瀛怡翦痫箝糸镱篝蝈犴┅è博黩轸瀛獗痫箝糸镱篝蝈犴┅è穿黩轸瀛獬痫箝糸镱篝蝈犴┅è俯黩轸瀛舛痫箝糸镱篝蝈犴┅┅ㄤ彐礤翳镤孱泔溴è轭篝泔铙泸遽麸颟篝蝈犴黩轸瀛眍屙镱殂с镱篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝蝠灬汜轭轸篝蝈犴黩轸瀛眍屙镱殂蝠灬汜篝蝈犴黩轸瀛轭溴蝠灬悱泔铙轭篝篝蝈犴黩轸瀛轭溴蝠灬悱鲠祯轭篝篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝蝠灬沅轭轸篝蝈犴黩轸瀛眍屙镱殂蝠灬沅篝蝈犴黩轸瀛轭溴蝠灬悱泔铙轭篝篝蝈犴黩轸瀛轭溴蝠灬悱鲠祯轭篝篝蝈犴┅ㄤ彐躅黩轸瀛溟礤铙轱铙ㄤ轫孱箝镱篝蝈犴戾è蜥铍戾铉翳溟礤铙轱铙┅躅戾篌蜥铍驳订ㄥ蝌矧⒚犷漉眇犷狎蜥镦溟礤铙轱铙蜥铍┅黩轸瀛怡翦蜥铍篝蝈犴┅换项禊赭怡翦骘铒鳟烷玷麽铘溟骀弪孱镳泔溴骘灬蜱弪换矧箜犰戾蚩溟礤铙轱铙躅戾篌蝈漉沐＇溟礤铙轱铙兜党订ㄥ蝌矧⒚犷漉眇犷狎蜥鏖翳屐屙孱趔蝈漉沐＇溟礤铙轱铙┅ㄤ镬轶ㄤ轫溟礤铙轱铙黩轸瀛獗溟篝蝈犴┅ㄤ彐磲泸黩轸瀛篚猸怡翦ㄡ蝌狴篝蝈犴钼轸螬戾è疱蜮翦ㄦ祜矧钼轸螬ㄡㄧ孱簌⒘乙临┅ㄧ孱簌⒂砸帕廷┅啜戾舄è狎蜥ì篝蝈犴麸翎飙箝ㄡ蝌狴麸翎飙箝岍┅眭祠轲戾鲠祯瀛忾钿ㄦ蹯飙怡翦蝈磲轭溴颟ㄦ祜矧麸翎飙箝俯祜镳骘怡翦轭溴忮祜骢祆怡翦骘轭溴í疱蜮翦怡翦轭溴骘怡翦祜玳矧括祜镳骘忮祜疱蜮翦骘箬殒ōí钼轸螬钼轸螬骘蝽啜蝻鳝磲觑颦狎彐ǐ轭溴椹泔祆邈啜狍蝽箬殒舂┅滹黩轸瀛怡翦怡翦螬换黩轸蝈磲轭溴戾舄è轭溴í钼轸骢祆怡翦螬ㄢ翦癌祜镳骘忮祜蝈磲轭溴骘箬殒ōí钼轸螬钼轸螬骘蝽蝻鳝磲觑颦狎彐ǐ轭溴椹滹箦翩熹ㄢ翦钼轸箬殒舂怡翦蝽岍黩轸瀛怡翦怡翦螬┅┅ㄤ彐躅黩轸瀛豸娓ㄣ栳蜥泗弪狎蜥篝蝈犴ㄤ邈灬蝈镳糸黹箴邋洎豉疱ㄡ蝌狴汨狎徙翦颟汨狎徙翦颦狎蜥┅换琢椅晌呛族狍篚礤翳栾篝扉箴萌烈孟呐蝈趱蝾翳疹殂镤泔溴痫轭舢换澡轶轶翳汜箦镱犷翳轭筢铄痱镡徕禊箩忮磲脲翳筢礤狍篚眇糸镱换狍驷狍汜翦祆换韵南澡弪濮痱镡徕禊沆弼弪铄篌麸忮滹铄麸磲脲翳轶黩轸驷篝弪祜镳骘忮祜ㄡ蝌狴麸翎飙箝汨狎徙翦颦狎蜥骘汨狎蝻鳝磲觑颦狎彐汨狎徙翦颦狎蜥椹骘沭镩铘ㄣ栳颦泔溴汨狎滹ㄣ镱è沭镩铘ｘ赴镱怡翦黩轸瀛怡翦沭镩铘篝蝈犴┅è沭镩铘ｘ赴癌赭黩轸瀛怡翦祜玳矧ｂ北鞍鞍鞍熹ㄢ翦订沭镩铘┅篝蝈犴黩轸瀛怡翦祜玳矧ｂ卑鞍鞍鞍熹ㄢ翦癌沭镩铘┅篝蝈犴┅è沭镩铘ｘ卑鞍癌翳蝈黩轸瀛怡翦祜玳矧ｂ北卑鞍鞍熹ㄢ翦辈沭镩铘┅篝蝈犴黩轸瀛怡翦祜玳矧ｂ卑鞍鞍鞍熹ㄢ翦订沭镩铘┅篝蝈犴黩轸瀛怡翦祜玳矧ｂ卑鞍鞍鞍熹ㄢ翦癌沭镩铘┅篝蝈犴┅è沭镩铘ｘ北鞍鞍骘躜黩轸瀛怡翦祜玳矧ｂ北北鞍鞍熹ㄢ翦备沭镩铘┅篝蝈犴黩轸瀛怡翦祜玳矧ｂ卑鞍鞍鞍熹ㄢ翦辈沭镩铘┅篝蝈犴黩轸瀛怡翦祜玳矧ｂ卑鞍鞍鞍熹ㄢ翦订沭镩铘┅篝蝈犴黩轸瀛怡翦祜玳矧ｂ卑鞍鞍鞍熹ㄢ翦癌沭镩铘┅篝蝈犴┅换澡骘祆秣轭轶溴戾翦狍躅蝈徙栳忪镱瀹绠勇锰忮汜躞换轸腩秣翳狒汨狎泔溴滹弩瞌顼翳轶栝玷换娘瞌黠蝌徕秕轸铒犰祜麇怡移贸恫ㄥ蝌矧⒚镤痫轭ｘ骘汨狎徙翦恒轶秕镦蜥铉骘赵骗涪沭镩铘汨狎┅┅ㄤ彐礤翳镤孱泔溴è轭篝狎蜥泸遽麸颟篝蝈犴黩轸瀛眍屙镱殂ы犭瀛狎蜥篝蝈犴黩轸瀛怡翦踽弭泔溴轭篝篝蝈犴戾舄è疳汶轭绛轭骘疳汶轭绛轭骘轭篝┅ㄤ轫ㄤ轫孱箝镱轭篝┅疳汶轭绛豉疱ㄦ轵篝疳汶轭绛轭骘┅疳汶轭绛泔溴箦泔钿疳汶轭绛轭骘┅黩轸瀛怡翦疳汶轭绛泔溴篝蝈犴黩轸瀛溟礤铙轱铙溟眢篝蝈犴磲泸镬弭è漉眇é蝈篝骘蝽螬啜祜镳鏖翳狎痱雉雉疱轭篝骘忮祜ㄡ蝌狴麸翎飙箝狎颟骘屐屙蝻鳝磲觑颦狎彐狎椹滹梨矧眢┅ㄣ镱è羼踽疳汶轭绛豉疱ь殪┅牾篝铄邃溟眢è羼踽疳汶轭绛豉疱р狍瀛汨狎ㄤ蹴黩轸瀛怡翦ㄣ栳颦泔溴屐屙篝蝈犴┅è羼踽疳汶轭绛豉疱с栳蜥泗弪黩轸瀛豸娓痱雉雉疱轭篝篝蝈犴┅è羼踽疳汶轭绛豉疱箝铉戾骒镝舂ㄤ蹴黩轸瀛獬ㄩ邋瀛骒镝趔哄钽镤瀛骒镝舫屐屙篝蝈犴┅è羼踽疳汶轭绛豉疱т秕忪瀛骒镝舂ㄤ蹴黩轸瀛舛ㄩ邋瀛骒镝趔哄钽镤瀛骒镝舳屐屙篝蝈犴┅è羼踽疳汶轭绛豉疱Ж泔眇戾箝铉戾骒镝舂ㄤ蹴黩轸瀛獬ㄩ邋瀛骒镝趔哄钽镤瀛骒镝舫蝈犰疳螋屐屙┅篝蝈犴黩轸瀛獬ㄩ邋瀛骒镝趔哄钽镤瀛骒镝舫ㄩ磲琊狎屐屙┅篝蝈犴┅è羼踽疳汶轭绛豉疱Ж泔眇戾滹踱戾骒镝舂ㄤ蹴黩轸瀛舛ㄩ邋瀛骒镝趔哄钽镤瀛骒镝舳蝈犰疳螋屐屙┅篝蝈犴黩轸瀛舛ㄩ邋瀛骒镝趔哄钽镤瀛骒镝舳ㄩ磲琊狎屐屙┅篝蝈犴┅è羼踽疳汶轭绛豉疱р轸黩轸瀛篚猸怡翦痱雉雉疱轭篝篝蝈犴暴è羼踽疳汶轭绛豉疱Ж躅箝珙邃怡翦博黩轸瀛篚猸怡翦痱雉雉疱轭篝篝蝈犴博è羼踽疳汶轭绛豉疱Ж躅箝珙邃怡翦穿黩轸瀛篚猸怡翦痱雉雉疱轭篝篝蝈犴穿è羼踽疳汶轭绛豉疱Ж躅箝珙邃怡翦俯黩轸瀛箦聃孱沐痱雉雉疱轭篝篝蝈犴┅è羼踽疳汶轭绛豉疱Ж躅箝珙邃怡翦倍┅ㄤ蹴黩轸瀛獗屐屙篝蝈犴┅è羼踽疳汶轭绛豉疱Ж躅箝珙邃怡翦巢┅ㄤ蹴黩轸瀛獬屐屙篝蝈犴┅è羼踽疳汶轭绛豉疱Ж躅箝珙邃怡翦洞┅ㄤ蹴黩轸瀛舛屐屙篝蝈犴┅è羼踽疳汶轭绛豉疱Ж箝珙邃怡翦俯ㄤ蹴黩轸瀛怡翦熹ㄢ翦癌屐屙篝蝈犴┅è羼踽疳汶轭绛豉疱Ж箝珙邃怡翦倍┅ㄤ蹴黩轸瀛獗屐屙篝蝈犴┅è羼踽疳汶轭绛豉疱Ж箝珙邃怡翦巢┅ㄤ蹴黩轸瀛獬屐屙篝蝈犴┅è羼踽疳汶轭绛豉疱Ж箝珙邃怡翦洞┅ㄤ蹴黩轸瀛舛屐屙篝蝈犴┅换韵南娱珙邃怡翦è羼踽疳汶轭绛豉疱舂栳钿戾怡箦翩狎彐轭篝蝓泗轱铙ㄥ蝌矧⒙涨疹腩秣疳汶轭绛豉疱螈疳汶轭绛豉疱┅┅┅ㄤ彐礤翳镤孱泔溴è轭篝箦翩狎彐篝蝈犴黩轸瀛眍屙镱殂箦翩蝻鳝磲觑颦狎彐篝蝈犴黩轸瀛轭溴箦翩狎彐狎蜥轭篝篝蝈犴黩轸瀛獗箦翩狎彐轭溴轭篝篝蝈犴黩轸瀛轭溴箦翩狎彐鲠祯轭篝篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝栳箬翎忪瀛泸遽麸颟篝蝈犴戾舄è梏痱雉雉疱轭篝┅换韵南悯篝镯栳箬翎忪翦篝螽换蜗耘翳狒骘铒瞽沲篝镯栳箬翎忪翦篝蟋翳篝犷溽蜾换珲狎犷翦弩翳狒栳箬翎忪瀛翦篝蝈趱蝾簌礅镬翦篝泔溴ㄥ汜箦ㄨ狍璀翎忪瀛翦篝梏è羼ｂ鞍è羼飑ｂ氨è羼踽飑ｂ卑è羼踽祓ｂ北┅换骑铒鳜镱禊犰祜泔躅趔躔麸ｘ骀骀换娱钽翳泔躅轶牾篝栝铘忾珑弪栳箬翎忪弩汜篝殪换忮漉眇邃镫狴换彐骈汩孱泫蜗耘澡箝疳篌邃麸磲脲栳箬翎忪蝈犰禊换箴邈殒殄汜疳汩豉箫骘屮犴痨殒麇栳鲥犷仍鏖翳刀换孱趄殄蟋磲脲刀孱趄箝黹灬栳箬翎忪瀣犷篝狎骈祆轭轸换躔轸黹玷忮蝈栳箬邃犷蝈箝邃漉蜷铉轭轸獒扉狒轱狍轸换蝈徙桢翳蝈栳箬翳蝈箬镬洚犴铒篚蝈栾麸溴犰鏖翳翳轶换轭痫螋徕戾驷箬轱町麇泔蹯牾篝轭鲥螋痱秭殇邃蝈栳箬箝蹇ㄣ秕铘磲ㄨ狍璀翎忪瀛泔躅梏ｘ骀骀┅黩轸瀛眍屙镱殂ы犭瀛栳箬翎忪篝蝈犴黩轸瀛怡翦翦篝泔溴篝蝈犴黩轸瀛獗泔躅篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝箦翩珏翳狍瑭篝蝈犴黩轸瀛眍屙镱殂Ж箦翩珏翳狍瑭篝蝈犴黩轸瀛轭溴箦翩珏翳狍璀栳箬翎忪轭篝篝蝈犴黩轸瀛轭溴箦翩珏翳狍璀脲轭篝篝蝈犴黩轸瀛轭溴箦翩珏翳狍璀鲠祯轭篝篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝箝铉戾麸瞽泸遽麸颟篝蝈犴ㄥ汜箦痱雉雉疱轭篝è铋飑黩轸瀛眍屙镱殂ь殪篝蝈犴┅è舂黩轸瀛眍屙镱殂篝蝈犴┅┅ㄤ彐礤翳镤孱泔溴è轭篝簌礅镬泸遽麸颟篝蝈犴黩轸瀛眍屙镱殂ы犭瀛簌礅镬篝蝈犴黩轸瀛轭溴簌礅镬泸遽麸颦钺礤轭篝篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝轭翦蝾邃簌礅镬泸遽麸颟篝蝈犴黩轸瀛眍屙镱殂ч铘弪篝蝈犴黩轸瀛轭溴簌礅镬泸遽麸颦疳汶徵轭篝篝蝈犴黩轸瀛轭溴簌礅镬泸遽麸颦钺礤轭篝篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝疳汶徵瀛泸遽麸颟篝蝈犴黩轸瀛眍屙镱殂ф轭洵疳汶徵篝蝈犴黩轸瀛轭溴疳汶徵瀛泸遽麸颦钺礤轭篝篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝汨狎徙翦颦泸遽麸颟篝蝈犴黩轸瀛眍屙镱殂ы犭瀛汨狎徙翦篝蝈犴黩轸瀛獬ㄣ栳颦泔溴痱雉雉疱轭篝┅篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝疳翳钺礤泸遽麸颟篝蝈犴黩轸瀛眍屙镱殂ы犭瀛疳翳钺礤篝蝈犴黩轸瀛轭溴疳翳钺礤泸遽麸颦栾篝轭篝篝蝈犴黩轸瀛轭溴疳翳钺礤泸遽麸颦溴鲩沐轭篝篝蝈犴黩轸瀛轭溴疳翳钺礤泸遽麸颦溟蝈泗矧轭篝篝蝈犴黩轸瀛轭溴疳翳钺礤泸遽麸颦钺礤轭篝篝蝈犴黩轸瀛轭溴疳翳钺礤泸遽麸颦豉疱轭篝篝蝈犴黩轸瀛轭溴疳翳钺礤泸遽麸颦鲥蝮轱轭篝篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝筲洞泸遽麸颟篝蝈犴黩轸瀛眍屙镱殂ы犭瀛筲洞篝蝈犴黩轸瀛舛痱雉雉疱轭篝篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝忾珙蹴泸遽麸颟篝蝈犴换躞弩箝珙磲珙轸蹁蝈痱弩孱翎糸镱黩轸瀛眍屙镱殂ы犭瀛忾珙蹴篝蝈犴戾舄è铛礅弪痱雉雉疱轭篝┅ㄡ铛礅弪ㄡ怏铛礅弪┅铟矧潴ㄣ彘扉铉ㄩ铘彗弪戾铉翳犷蹴忮颟洞┅铄琊黹铛箴铛礅弪┅黩轸瀛舛ㄩ铄琊ō铟矧潴铟矧潴篝蝈犴祜镳骘骝镯铟矧潴徕秭骘痫íū椹洞骘黠蜾熹ㄢ翦洞痫螬犷蹴忮颟滹黩轸瀛舛黠蜾篝蝈犴┅┅ㄤ彐礤翳镤孱泔溴è轭篝箝铉戾骒镝舡泸遽麸颟篝蝈犴黩轸瀛眍屙镱殂ы犭瀛箝铉戾骒镝篝蝈犴黩轸瀛獬ㄩ邋瀛骒镝趔哄钽镤瀛骒镝舫痱雉雉疱轭篝┅篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝滹踱戾骒镝舡泸遽麸颟篝蝈犴黩轸瀛眍屙镱殂ы犭瀛滹踱戾骒镝篝蝈犴黩轸瀛舛ㄩ邋瀛骒镝趔哄钽镤瀛骒镝舳痱雉雉疱轭篝┅篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝蜥糸锃泸遽麸颟篝蝈犴黩轸瀛眍屙镱殂蜥糸篝蝈犴黩轸瀛轭溴蜥糸锃泸遽麸颦铛礤蜥麸轭篝篝蝈犴黩轸瀛轭溴蜥糸锃泸遽麸颦溴铒黹钺麸轭篝篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝泔眇戾泸遽麸颟篝蝈犴黩轸瀛眍屙镱殂с镯痨屮篝蝈犴黩轸瀛轭溴ㄣ镯痨屮泸遽麸颦蝈犰疳螋轭篝篝蝈犴黩轸瀛轭溴ㄣ镯痨屮泸遽麸颦轫徵疳螋轭篝篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝驿彐轭轸轱瞽祜镫躔篝蝈犴黩轸瀛眍屙镱殂ф溴骈铋糸镱篝蝈犴黩轸瀛轭溴钺礤轭篝篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝驺屐飙祜镫躔篝蝈犴黩轸瀛眍屙镱殂ф沐祆篝蝈犴黩轸瀛轭溴钺礤轭篝篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝鲢屐飙祜镫躔篝蝈犴黩轸瀛眍屙镱殂鲢屐篝蝈犴黩轸瀛轭溴钺礤轭篝篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝孱鲩蝻铐孱舡祜镫躔篝蝈犴黩轸瀛眍屙镱殂у铞轵镱礤铘篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝珏铄蜥飙泸遽麸颟篝蝈犴黩轸瀛眍屙镱殂ф躅汜祆泸遽翦篝蝈犴黩轸瀛轭溴ㄧ孱弪犰骢钽糸镱轭篝篝蝈犴黩轸瀛獗戾铉翳ㄧ孱弪犰狎珲礤铘轭篝┅篝蝈犴祜镳骘狎轭ㄧ孱弪犰狎珲礤铘轭篝滹黩轸瀛轭溴狎篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝珏铄蜥飙轭轸獒扉弪篝蝈犴黩轸瀛眍屙镱殂ф躅汜祆轭轸獒扉篝蝈犴黩轸瀛轭溴ㄧ孱弪犰骢钽糸镱轭篝篝蝈犴黩轸瀛獗戾铉翳ㄧ孱弪犰狎珲礤铘轭篝┅篝蝈犴祜镳骘狎轭ㄧ孱弪犰狎珲礤铘轭篝滹黩轸瀛轭溴狎篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝沆狍蟓泸遽麸颟篝蝈犴黩轸瀛眍屙镱殂ф轭洵沆狍篝蝈犴黩轸瀛轭溴ㄣ灬篌泸遽麸颦钺礤轭篝篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝祜徜糸礤鲠祯瀛泸遽麸颟篝蝈犴黩轸瀛眍屙镱殂ф躅汜祆泸遽翦篝蝈犴黩轸瀛轭溴祜徜糸礤鲠祯瀛泸遽麸颦骢钽糸镱轭篝篝蝈犴换铒狎珲礤铘黩轸瀛獗篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝怡翦骢钽糸镱泸遽麸颟篝蝈犴黩轸瀛眍屙镱殂ы犭瀛怡翦泔溴骢钽糸镱篝蝈犴黩轸瀛獬ㄥ铘蝙痫轭轭篝篝蝈犴黩轸瀛獬箝轭篝篝蝈犴黩轸瀛獗铎镢犰轭篝篝蝈犴黩轸瀛獗钽祜箦轭篝篝蝈犴黩轸瀛轭溴盹漉戾轭篝篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝怡翦盹漉戾泸遽麸颟篝蝈犴换昨轸轭篝蝓泗轱铙黩轸瀛眍屙镱殂ы犭瀛怡翦泔溴盹漉戾篝蝈犴戾舄è扉箴泔溴ㄢ翦盹漉戾扉箴泔溴轭篝┅戾戾铉翳扉箴泔溴┅麒孱戾．ㄡ箬巢┅ㄥ蝌矧⒙翦泔溴戾铉翳轶洮麸祜铉麸漉眇戾瞟黩轸瀛獬戾篝蝈犴黩轸瀛箦聃孱沐扉箴泔溴篝蝈犴┅ㄤ彐礤翳镤孱泔溴è轭篝箦翩扉翦蜥祗篝蝈犴黩轸瀛眍屙镱殂箦翩扉翦蜥祗篝蝈犴黩轸瀛轭溴箦翩扉翦蜥祗盹漉戾轭篝篝蝈犴戾è扉翦蜥祗箦翩扉翦蜥祗扉翦蜥祗轭篝┅黩轸瀛獗戾铉翳扉翦蜥祗篝蝈犴祜镳骘泸遽麸徙蝻篌扉翦蜥祗滹黩轸瀛轭溴泸遽麸篝蝈犴┅┅换ㄤ彐礤翳镤孱泔溴衡彐矧è狒趄狒趄殁豸濠篝蝈犴黩轸瀛眍屙镱殂п趑蜷怩翦篝蝈犴黩轸瀛轭溴钺礤狒趄篝蝈犴┅ㄤ彐礤翳镤孱泔溴è狒趄滹泱趄轭绛狒趄篝蝈犴换昨轸翳戾铉翳黩轸瀛獬ǐ轭溴怡翦螵轭溴怡翦螵篝蝈犴换令翳溽翎黩轸瀛轭溴镡赍泗狒趄篝蝈犴黩轸瀛轭溴ㄤ镢篝蜷铉狒趄篝蝈犴┅ㄤ彐礤翳镤孱泔溴è狒趄钺礤狒趄篝蝈犴黩轸瀛獬ǐ轭溴怡翦螵轭溴怡翦螵篝蝈犴黩轸瀛轭溴镡赍泗狒趄篝蝈犴黩轸瀛轭溴镡觐犴狒趄篝蝈犴┅ㄤ彐礤翳镤孱泔溴è狒趄灬礅溽扉篝狒趄篝蝈犴黩轸瀛獬ǐ轭溴怡翦螵轭溴怡翦螵篝蝈犴黩轸瀛轭溴祆骢钽糸镱狒趄篝蝈犴黩轸瀛轭溴灬礅溽扉篝狒趄篝蝈犴┅换ㄤ彐礤翳镤孱泔溴è轭轸轭轸镡赍泗狎蜥篝蝈犴黩轸瀛眍屙镱殂ч铋舡镡赍泗狎蜥篝蝈犴黩轸瀛舛ㄩ铋舡镡赍泗狎蜥泔躅轭轸篝蝈犴┅